name: get windows iso
run-name: ${{ github.actor }} GitHub Actions get windows11 iso
on:
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # windows-latest # For Linux, use ubuntu-latest
    steps:
    - name: 'Checkout GitHub Action'
      uses: actions/checkout@v3

    - name: 'init System'
      run: |
        sudo apt-get install aria2 cabextract wimtools chntpw genisoimage -y

    - name: 'Run UUP Dump'
      run: |

        chmod +x *.sh && ./uup_download_linux.sh
        mkdir isoBin && mv *.ISO isoBin

    - name: Upload ISO To Artifact
      uses: actions/upload-artifact@main
      if: (!cancelled())
      with:
        name: isoBin
        path: isoBin

    - name: Upload ISO To WeTransfer
      id: wetransfer
      if: (!cancelled())
      run: |
        curl -fsSL git.io/file-transfer | sh
        ./transfer wet -s -p 16 --no-progress isoBin 2>&1 | tee wetransfer.log
        echo "::warning file=wetransfer.com::$(cat wetransfer.log | grep https)"
